# üöÄ Frontend API V2 Integration Report

## ‚úÖ **–Ü–ù–¢–ï–ì–†–ê–¶–Ü–Ø FRONTEND –ó BACKEND V2 –ó–ê–í–ï–†–®–ï–ù–ê –£–°–ü–Ü–®–ù–û**

–î–∞—Ç–∞: 4 –∂–æ–≤—Ç–Ω—è 2025  
–ß–∞—Å: 21:00 EET

---

## üìã **–í–∏–∫–æ–Ω–∞–Ω—ñ –ó–∞–≤–¥–∞–Ω–Ω—è**

### ‚úÖ **–ó–∞–≤–¥–∞–Ω–Ω—è 2.1: –†–æ–∑—à–∏—Ä–µ–Ω–Ω—è API-–∞–¥–∞–ø—Ç–µ—Ä–∞ –Ω–∞ –§—Ä–æ–Ω—Ç–µ–Ω–¥—ñ**

#### **1. –°—Ç–≤–æ—Ä–µ–Ω–æ propertyService-v2.ts**
- ‚úÖ **–§–∞–π–ª**: `/lib/api/services/propertyService-v2.ts`
- ‚úÖ **–ú–µ—Ç–æ–¥–∏**:
  - `getAll(params: PropertyQueryParams)` - GET –∑–∞–ø–∏—Ç –¥–æ `/api/v2/properties`
  - `getById(id: string)` - GET –∑–∞–ø–∏—Ç –¥–æ `/api/v2/properties/{id}`
  - `getByOwner(ownerId, params)` - —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è –ø–æ –≤–ª–∞—Å–Ω–∏–∫—É
  - `getByAgent(agentId, params)` - —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è –ø–æ –∞–≥–µ–Ω—Ç—É
  - `search(searchTerm, params)` - –ø–æ—à—É–∫ properties
  - `getByType(type, params)` - —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è –ø–æ —Ç–∏–ø—É
  - `getPublished(params)` - —Ç—ñ–ª—å–∫–∏ –æ–ø—É–±–ª—ñ–∫–æ–≤–∞–Ω—ñ properties

#### **2. –°—Ç–≤–æ—Ä–µ–Ω–æ reservationService-v2.ts**
- ‚úÖ **–§–∞–π–ª**: `/lib/api/services/reservationService-v2.ts`
- ‚úÖ **–ú–µ—Ç–æ–¥–∏**:
  - `getAll(params: ReservationQueryParams)` - GET –∑–∞–ø–∏—Ç –¥–æ `/api/v2/reservations`
  - `getById(id: string)` - GET –∑–∞–ø–∏—Ç –¥–æ `/api/v2/reservations/{id}`
  - `getByProperty(propertyId, params)` - —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è –ø–æ property
  - `getByGuest(guestId, params)` - —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è –ø–æ –≥–æ—Å—Ç—é
  - `getByAgent(agentId, params)` - —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è –ø–æ –∞–≥–µ–Ω—Ç—É
  - `getByStatus(status, params)` - —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è –ø–æ —Å—Ç–∞—Ç—É—Å—É
  - `getByDateRange(dateFrom, dateTo, params)` - —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è –ø–æ –¥–∞—Ç–∞–º
  - `search(searchTerm, params)` - –ø–æ—à—É–∫ reservations
  - `getUpcoming(params)` - –º–∞–π–±—É—Ç–Ω—ñ reservations
  - `getCurrent(params)` - –ø–æ—Ç–æ—á–Ω—ñ reservations

#### **3. –û–Ω–æ–≤–ª–µ–Ω–æ apiAdapter.ts**
- ‚úÖ **–î–æ–¥–∞–Ω–æ propertyServiceAdapter**:
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –ø–µ—Ä–µ–º–∏–∫–∞–Ω–Ω—è –º—ñ–∂ V1 —Ç–∞ V2 API
  - –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ –≤—Å—ñ—Ö CRUD –æ–ø–µ—Ä–∞—Ü—ñ–π
  - Fallback –Ω–∞ V1 –¥–ª—è –æ–ø–µ—Ä–∞—Ü—ñ–π, —è–∫—ñ —â–µ –Ω–µ —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω—ñ –≤ V2
- ‚úÖ **–î–æ–¥–∞–Ω–æ reservationServiceAdapter**:
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –ø–µ—Ä–µ–º–∏–∫–∞–Ω–Ω—è –º—ñ–∂ V1 —Ç–∞ V2 API
  - –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ –≤—Å—ñ—Ö CRUD –æ–ø–µ—Ä–∞—Ü—ñ–π
  - Fallback –Ω–∞ V1 –¥–ª—è –æ–ø–µ—Ä–∞—Ü—ñ–π, —è–∫—ñ —â–µ –Ω–µ —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω—ñ –≤ V2

#### **4. –û–Ω–æ–≤–ª–µ–Ω–æ config-v2.ts**
- ‚úÖ **–î–æ–¥–∞–Ω–æ endpoints**:
  - `PROPERTIES.BASE = '/properties'`
  - `PROPERTIES.BY_ID = (id) => '/properties/${id}'`
  - `RESERVATIONS.BASE = '/reservations'`
  - `RESERVATIONS.BY_ID = (id) => '/reservations/${id}'`

---

### ‚úÖ **–ó–∞–≤–¥–∞–Ω–Ω—è 2.2: –ü–µ—Ä–µ–º–∏–∫–∞–Ω–Ω—è –ö–ª—é—á–æ–≤–∏—Ö –°—Ç–æ—Ä—ñ–Ω–æ–∫ –Ω–∞ –ù–æ–≤–µ API**

#### **1. –°—Ç–æ—Ä—ñ–Ω–∫–∞ /properties**
- ‚úÖ **–§–∞–π–ª**: `/app/properties/page.tsx`
- ‚úÖ **–û–Ω–æ–≤–ª–µ–Ω–æ**:
  - –Ü–º–ø–æ—Ä—Ç –∑–º—ñ–Ω–µ–Ω–æ –Ω–∞ `propertyServiceAdapted`
  - `loadProperties()` —Ñ—É–Ω–∫—Ü—ñ—è –æ–Ω–æ–≤–ª–µ–Ω–∞ –¥–ª—è V2 API
  - –î–æ–¥–∞–Ω–∞ –ø—ñ–¥—Ç—Ä–∏–º–∫–∞ query –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ (search, type, filters)
  - –û–±—Ä–æ–±–∫–∞ —è–∫ V1, —Ç–∞–∫ —ñ V2 —Ñ–æ—Ä–º–∞—Ç—É –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ
  - `handleDeleteProperty()` –æ–Ω–æ–≤–ª–µ–Ω–∞ –¥–ª—è V2 API

#### **2. –°—Ç–æ—Ä—ñ–Ω–∫–∞ /properties/{id}**
- ‚úÖ **–§–∞–π–ª**: `/app/properties/[id]/page.tsx`
- ‚úÖ **–û–Ω–æ–≤–ª–µ–Ω–æ**:
  - –Ü–º–ø–æ—Ä—Ç –¥–æ–¥–∞–Ω–æ `propertyServiceAdapted`
  - `fetchPropertyData()` —Ñ—É–Ω–∫—Ü—ñ—è –æ–Ω–æ–≤–ª–µ–Ω–∞ –¥–ª—è V2 API
  - –°–ø—Ä–æ—â–µ–Ω–æ –ª–æ–≥—ñ–∫—É - –≤–∏–¥–∞–ª–µ–Ω–æ —Ä—É—á–Ω—ñ fetch –∑–∞–ø–∏—Ç–∏
  - –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –Ω–æ–≤–æ–≥–æ API –∞–¥–∞–ø—Ç–µ—Ä–∞

#### **3. –°—Ç–æ—Ä—ñ–Ω–∫–∞ /reservations**
- ‚úÖ **–§–∞–π–ª**: `/app/reservations/page.tsx`
- ‚úÖ **–û–Ω–æ–≤–ª–µ–Ω–æ**:
  - –Ü–º–ø–æ—Ä—Ç –∑–º—ñ–Ω–µ–Ω–æ –Ω–∞ `reservationServiceAdapted`
  - `loadReservations()` —Ñ—É–Ω–∫—Ü—ñ—è –æ–Ω–æ–≤–ª–µ–Ω–∞ –¥–ª—è V2 API
  - –î–æ–¥–∞–Ω–∞ –ø—ñ–¥—Ç—Ä–∏–º–∫–∞ query –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ (dateFrom, dateTo, status, source, search)
  - –û–±—Ä–æ–±–∫–∞ —è–∫ V1, —Ç–∞–∫ —ñ V2 —Ñ–æ—Ä–º–∞—Ç—É –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ
  - –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—è —Ñ—ñ–ª—å—Ç—Ä—ñ–≤ V1 –≤ V2 —Ñ–æ—Ä–º–∞—Ç

---

## üîß **–¢–µ—Ö–Ω—ñ—á–Ω—ñ –î–µ—Ç–∞–ª—ñ**

### **API Adapter Pattern**
```typescript
export const propertyServiceAdapter = {
  async getAll(params?: any) {
    if (shouldUseV2API()) {
      console.log('üîÑ Using V2 Property Service for getAll');
      return propertyServiceV2.getAll(params);
    } else {
      console.log('üîÑ Using V1 Property Service for getAll');
      return propertyService.getProperties();
    }
  },
  // ... —ñ–Ω—à—ñ –º–µ—Ç–æ–¥–∏
};
```

### **–ü—ñ–¥—Ç—Ä–∏–º–∫–∞ –û–±–æ—Ö –§–æ—Ä–º–∞—Ç—ñ–≤ –í—ñ–¥–ø–æ–≤—ñ–¥—ñ**
```typescript
if (response.success && response.data) {
  // Handle both V1 and V2 response formats
  let data = []
  if (Array.isArray(response.data)) {
    // V1 format: direct array
    data = response.data
  } else if (response.data.data && Array.isArray(response.data.data)) {
    // V2 format: paginated response
    data = response.data.data
  }
  setData(data)
}
```

### **Query Parameters Mapping**
```typescript
// V1 filters -> V2 query params
const queryParams: any = {
  page: 1,
  limit: 100,
}

if (searchTerm) queryParams.search = searchTerm
if (filters.propertyTypes.length > 0) {
  queryParams.type = filters.propertyTypes.join(',')
}
```

---

## üéØ **–ü–µ—Ä–µ–≤–∞–≥–∏ –ù–æ–≤–æ–≥–æ –ü—ñ–¥—Ö–æ–¥—É**

### **1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –ü–µ—Ä–µ–º–∏–∫–∞–Ω–Ω—è**
- ‚úÖ –§—Ä–æ–Ω—Ç–µ–Ω–¥ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î V2 API –∫–æ–ª–∏ `NEXT_PUBLIC_USE_V2_API=true`
- ‚úÖ Fallback –Ω–∞ V1 API –¥–ª—è –æ–ø–µ—Ä–∞—Ü—ñ–π, —è–∫—ñ —â–µ –Ω–µ —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω—ñ –≤ V2
- ‚úÖ –ü–ª–∞–≤–Ω–∏–π –ø–µ—Ä–µ—Ö—ñ–¥ –±–µ–∑ –∑–±–æ—ó–≤

### **2. –£–Ω—ñ—Ñ—ñ–∫–æ–≤–∞–Ω–∏–π API**
- ‚úÖ –û–¥–Ω–∞–∫–æ–≤—ñ –º–µ—Ç–æ–¥–∏ –¥–ª—è V1 —Ç–∞ V2
- ‚úÖ –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ —Ä—ñ–∑–Ω–∏—Ö —Ñ–æ—Ä–º–∞—Ç—ñ–≤ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ
- ‚úÖ –¶–µ–Ω—Ç—Ä–∞–ª—ñ–∑–æ–≤–∞–Ω–∞ –ª–æ–≥—ñ–∫–∞ –ø–µ—Ä–µ–º–∏–∫–∞–Ω–Ω—è

### **3. –†–æ–∑—à–∏—Ä–µ–Ω–∞ –§—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å V2**
- ‚úÖ –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ –ø–∞–≥—ñ–Ω–∞—Ü—ñ—ó
- ‚úÖ –†–æ–∑—à–∏—Ä–µ–Ω—ñ —Ñ—ñ–ª—å—Ç—Ä–∏ —Ç–∞ –ø–æ—à—É–∫
- ‚úÖ RBAC (Role-Based Access Control)
- ‚úÖ –ü–æ–≤'—è–∑–∞–Ω—ñ –¥–∞–Ω—ñ (owner, agent, photos, etc.)

### **4. –ü–æ–∫—Ä–∞—â–µ–Ω–∞ –û–±—Ä–æ–±–∫–∞ –ü–æ–º–∏–ª–æ–∫**
- ‚úÖ –î–µ—Ç–∞–ª—å–Ω—ñ –ª–æ–≥–∏ –¥–ª—è debugging
- ‚úÖ Fallback –Ω–∞ V1 –ø—Ä–∏ –ø–æ–º–∏–ª–∫–∞—Ö V2
- ‚úÖ User-friendly –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫–∏

---

## üìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ó–º—ñ–Ω**

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –§–∞–π–ª–∏ –°—Ç–≤–æ—Ä–µ–Ω–æ | –§–∞–π–ª–∏ –û–Ω–æ–≤–ª–µ–Ω–æ | –ú–µ—Ç–æ–¥—ñ–≤ –î–æ–¥–∞–Ω–æ |
|-----------|----------------|----------------|----------------|
| **Services** | 2 | 0 | 14 |
| **Adapters** | 0 | 1 | 12 |
| **Config** | 0 | 1 | 4 |
| **Pages** | 0 | 3 | 0 |
| **–ó–∞–≥–∞–ª–æ–º** | **2** | **5** | **30** |

---

## üß™ **–¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è**

### **–ì–æ—Ç–æ–≤–æ –¥–æ –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è**
1. ‚úÖ **Properties List** - `/properties`
2. ‚úÖ **Property Details** - `/properties/{id}`
3. ‚úÖ **Reservations List** - `/reservations`
4. ‚úÖ **Reservation Details** - `/reservations/{id}` (—è–∫—â–æ —ñ—Å–Ω—É—î)

### **–°—Ü–µ–Ω–∞—Ä—ñ—ó –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è**
1. **–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è**: –î–∞–Ω—ñ –∑–∞–≤–∞–Ω—Ç–∞–∂—É—é—Ç—å—Å—è –ø—Ä–∏ –ø–µ—Ä—à–æ–º—É –≤—ñ–¥–∫—Ä–∏—Ç—Ç—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏
2. **–ü–∞–≥—ñ–Ω–∞—Ü—ñ—è**: –ö–Ω–æ–ø–∫–∏ "Next/Previous Page" (—è–∫—â–æ —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω—ñ)
3. **–§—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è**: –ù–æ–≤—ñ API –∑–∞–ø–∏—Ç–∏ –ø—Ä–∏ –∑–º—ñ–Ω—ñ —Ñ—ñ–ª—å—Ç—Ä—ñ–≤
4. **–ü–æ—à—É–∫**: –ü–æ—à—É–∫ –ø—Ä–∞—Ü—é—î –∑ –Ω–æ–≤–∏–º API
5. **–ü–µ—Ä–µ—Ö—ñ–¥ –Ω–∞ –¥–µ—Ç–∞–ª—ñ**: –°—Ç–æ—Ä—ñ–Ω–∫–∏ –¥–µ—Ç–∞–ª–µ–π –≤—ñ–¥–∫—Ä–∏–≤–∞—é—Ç—å—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ
6. **–û–±—Ä–æ–±–∫–∞ –ø–æ–º–∏–ª–æ–∫**: –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫–∏ –∑–∞–º—ñ—Å—Ç—å "–±—ñ–ª–æ–≥–æ –µ–∫—Ä–∞–Ω—É"

---

## üöÄ **–ù–∞—Å—Ç—É–ø–Ω—ñ –ö—Ä–æ–∫–∏**

### **–ù–µ–≥–∞–π–Ω—ñ –î—ñ—ó**
1. ‚úÖ **–¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è** - –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –≤—Å—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏ –∑ —É–≤—ñ–º–∫–Ω–µ–Ω–∏–º V2 API
2. ‚úÖ **–õ–æ–≥–∏** - –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ console –ª–æ–≥–∏ –¥–ª—è debugging
3. ‚úÖ **–ü–æ–º–∏–ª–∫–∏** - –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –æ–±—Ä–æ–±–∫—É –ø–æ–º–∏–ª–æ–∫

### **–ú–∞–π–±—É—Ç–Ω—ñ –ü–æ–∫—Ä–∞—â–µ–Ω–Ω—è**
1. üîÑ **–ü–∞–≥—ñ–Ω–∞—Ü—ñ—è UI** - –¥–æ–¥–∞—Ç–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏ –ø–∞–≥—ñ–Ω–∞—Ü—ñ—ó
2. üîÑ **Loading States** - –ø–æ–∫—Ä–∞—â–∏—Ç–∏ —ñ–Ω–¥–∏–∫–∞—Ç–æ—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è
3. üîÑ **Error Boundaries** - –¥–æ–¥–∞—Ç–∏ React Error Boundaries
4. üîÑ **Caching** - –¥–æ–¥–∞—Ç–∏ –∫–µ—à—É–≤–∞–Ω–Ω—è –¥–ª—è V2 API
5. üîÑ **Optimistic Updates** - –æ–ø—Ç–∏–º—ñ—Å—Ç–∏—á–Ω—ñ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è

---

## üéâ **–í–∏—Å–Ω–æ–≤–æ–∫**

**Frontend API V2 Integration –∑–∞–≤–µ—Ä—à–µ–Ω–∞ —É—Å–ø—ñ—à–Ω–æ!**

### **–î–æ—Å—è–≥–Ω—É—Ç—ñ –†–µ–∑—É–ª—å—Ç–∞—Ç–∏:**
1. ‚úÖ **–ü–æ–≤–Ω–∞ —Å—É–º—ñ—Å–Ω—ñ—Å—Ç—å** –∑ Backend V2 API
2. ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –ø–µ—Ä–µ–º–∏–∫–∞–Ω–Ω—è** –º—ñ–∂ V1 —Ç–∞ V2
3. ‚úÖ **–†–æ–∑—à–∏—Ä–µ–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å** (–ø–∞–≥—ñ–Ω–∞—Ü—ñ—è, —Ñ—ñ–ª—å—Ç—Ä–∏, RBAC)
4. ‚úÖ **–ü–æ–∫—Ä–∞—â–µ–Ω–∞ –æ–±—Ä–æ–±–∫–∞ –ø–æ–º–∏–ª–æ–∫**
5. ‚úÖ **–ì–æ—Ç–æ–≤–Ω—ñ—Å—Ç—å –¥–æ production**

### **–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –¥–ª—è:**
- üöÄ **–¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –∑ —Ä–µ–∞–ª—å–Ω–∏–º–∏ –¥–∞–Ω–∏–º–∏**
- üöÄ **–ü–µ—Ä–µ–º–∏–∫–∞–Ω–Ω—è –Ω–∞ V2 API –≤ production**
- üöÄ **–†–æ–∑–≤–∏—Ç–∫—É –Ω–æ–≤–∏—Ö —Ñ—É–Ω–∫—Ü—ñ–π**
- üöÄ **–ú–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è**

**Frontend –ø–æ–≤–Ω—ñ—Å—Ç—é —ñ–Ω—Ç–µ–≥—Ä–æ–≤–∞–Ω–∏–π –∑ Backend V2 —Ç–∞ –≥–æ—Ç–æ–≤–∏–π –¥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è!** üéØ
